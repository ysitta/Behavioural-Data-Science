panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234"),
panel.grid.minor.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", lwd = 2),
panel.grid.minor.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", lwd = 1),
panel.grid.minor.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 1),
panel.grid.minor.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 10),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold"),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "Proportion of Democrat and Republic party in US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c", hjust = 0.5, face = "bold", size = 14),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold"),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 14),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 14),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 16),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3, linewidth = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 7),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 8),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 6),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 4),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 2),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
votes_agg %>%
ggplot(aes(x = party, y = total)) +
geom_col(aes(fill = party)) +
geom_text(aes(label = percentage, y = total*0.95), col = "white", size = 4.3) +
labs(title = "PROPORTION OF DEMOCRAT & REPUBLIC PARTY IN US",
x = "Party",
y = "Total") +
scale_fill_manual(values = c("#b12234", "#3c3b6c")) +
# theme_minimal() +
theme(legend.position = "none",
panel.grid = element_blank(),
plot.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
axis.title = element_text(colour = "#3c3b6c", face = "bold", size = 12),
axis.text = element_text(colour = "#3c3b6c", face = "bold", size = 12),
plot.title = element_text(colour = "#3c3b6c",
hjust = 0.5,
face = "bold",
size = 18),
panel.grid.major.y = element_line(colour = "#b12234", linetype = 3),
panel.grid.minor.y = element_line(colour = "#b12234", linetype = 1),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(colour = "#b12234"))
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE)
model
head(model)
model$tables
head(model$tables,2)
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
library(e1071)
library(rsample)
library(caret)
library(ggplot2) # to help us in making plot
library(plotly) # to make our plot interactive
library(tidyverse) # to help us do the data wrangling
library(ggrepel)
library(stringr)
votes <- read.csv("data_input/votes.txt")
names(votes) <- c("party",
"hcapped_infants",
"watercost_sharing",
"adoption_budget_reso",
"physfee_freeze",
"elsalvador_aid",
"religious_grps",
"antisatellite_ban",
"nicaraguan_contras",
"mxmissile",
"immigration",
"synfuels_cutback",
"education_funding",
"superfundright_sue",
"crime",
"dutyfree_exps",
"expadmin_southafr"
)
head(votes)
votes %>%
group_by(party) %>%
summarise(jumlah = n())
RNGkind(sample.kind = "Rounding")
set.seed(100)
splitted <- initial_split(data = votes, strata = "party", prop = 0.8)
train <- training(splitted)
test <- testing(splitted)
model_naive <- naiveBayes(party~., data = train, laplace = 1)
head(model_naive$tables,2)
pred <- predict(model_naive, newdata = test)
pred
head(pred)
pred <- predict(model_naive, newdata = test)
head(test)
head(pred)
confusionMatrix(pred, reference = test$party, positive = "republican")
